var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e){for(const t of n)t(void 0);return t}const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function a(t){let e;return c(t,(t=>e=t))(),e}function s(t,e,n){t.$$.on_destroy.push(c(e,n))}function l(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function p(t){return document.createTextNode(t)}function v(){return p(" ")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t){return""===t?null:+t}function y(t,e){t.value=null==e?"":e}function x(t,e,n,o){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function $(t,e,n){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function k(t){const e=t.querySelector(":checked");return e&&e.__value}function _(t,e,n){t.classList.toggle(e,!!n)}let S;function O(t){S=t}function D(){if(!S)throw new Error("Function called outside component initialization");return S}function I(t){D().$$.on_mount.push(t)}function E(){const t=D();return(e,n,{cancelable:o=!1}={})=>{const i=t.$$.callbacks[e];if(i){const r=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}(e,n,{cancelable:o});return i.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const R=[],j=[];let C=[];const L=[],B=Promise.resolve();let F=!1;function W(t){C.push(t)}function A(t){L.push(t)}const M=new Set;let z=0;function N(){if(0!==z)return;const t=S;do{try{for(;z<R.length;){const t=R[z];z++,O(t),P(t.$$)}}catch(t){throw R.length=0,z=0,t}for(O(null),R.length=0,z=0;j.length;)j.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];M.has(e)||(M.add(e),e())}C.length=0}while(R.length);for(;L.length;)L.pop()();F=!1,M.clear(),O(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(W)}}const H=new Set;let T;function Y(t,e){t&&t.i&&(H.delete(t),t.i(e))}function J(t,e,n,o){if(t&&t.o){if(H.has(t))return;H.add(t),T.c.push((()=>{H.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function X(t){return void 0!==t?.length?t:Array.from(t)}function K(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function V(t){t&&t.c()}function U(t,n,r){const{fragment:c,after_update:a}=t.$$;c&&c.m(n,r),W((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),a.forEach(W)}function q(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];C.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),C=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function G(t,e){-1===t.$$.dirty[0]&&(R.push(t),F||(F=!0,B.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(e,i,r,c,a,s,l=null,u=[-1]){const f=S;O(e);const h=e.$$={fragment:null,ctx:[],props:s,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(f?f.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:i.target||f.$$.root};l&&l(h.root);let g=!1;if(h.ctx=r?r(e,i.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return h.ctx&&a(h.ctx[t],h.ctx[t]=i)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](i),g&&G(e,t)),n})):[],h.update(),g=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);h.fragment&&h.fragment.l(t),t.forEach(d)}else h.fragment&&h.fragment.c();i.intro&&Y(e.$$.fragment),U(e,i.target,i.anchor),N()}O(f)}class Z{$$=void 0;$$set=void 0;$destroy(){q(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var tt;"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4"),function(t){t.Fit="fit",t.Fill="fill",t.Stretch="stretch"}(tt||(tt={}));const et={[tt.Fill]:"Fill",[tt.Fit]:"Fit",[tt.Stretch]:"Stretch"},nt=1,ot=5,it=16;function rt(t){const{monthIndex:e,year:n,canvas:o}=t,{boxSize:{value:i},calendarColor:{value:r="#ffffff"},backgroundImage:{value:c},backgroundRect:{value:a},calendarRect:{value:s},imageFitOption:{value:l}}=t.month,u=o.getContext("2d");u.clearRect(0,0,o.width,o.height),c&&function(t,e,n,o,i){switch(i){case tt.Fit:!function(t,e,n,o){const i=e.width/e.height,r=n/o;let c,a,s,l;r>i?(a=o,c=a*i,s=(n-c)/2,l=0):(c=n,a=c/i,s=0,l=(o-a)/2);t.drawImage(e,s,l,c,a)}(t,e,n,o);break;case tt.Fill:!function(t,e,n,o){const i=e.width/e.height,r=n/o;let c,a,s,l;r>i?(c=n,a=c/i,s=0,l=(o-a)/2):(a=o,c=a*i,s=(n-c)/2,l=0);t.drawImage(e,s,l,c,a)}(t,e,n,o);break;case tt.Stretch:!function(t,e,n,o){t.drawImage(e,0,0,n,o)}(t,e,n,o)}}(u,c,o.width,o.height,l);const d=Math.max(Math.min(.01*i.width,ot),nt),f=it;u.fillStyle=r,u.strokeStyle=r,u.textBaseline="middle",u.textAlign="center",u.shadowColor="black",u.shadowOffsetX=1,u.shadowOffsetY=0,u.shadowBlur=4,u.lineWidth=d;let h=new Date(n,e,1).getDay()-1;h=-1===h?6:h;const g=new Date(n,e+1,0).getDate();let p=1,v=0,m=0;const b=7*i.width,w=s.x;let y=s.y;const x=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],$=`${["January","February","March","April","May","June","July","August","September","October","November","December"][e]} - ${n}`;u.font=`bold ${f+4}px Arial`;const k=u.measureText($),_=w+b/2,S=k.fontBoundingBoxAscent+k.fontBoundingBoxDescent;u.fillText($,_,y+S),u.font=`bold ${f}px Arial`,y+=1.5*S;const O=S;for(let t=0;t<7;t++){const e=w+t*i.width;u.fillText(x[t],e+i.width/2,y+O)}y+=2*O,u.font=`${f}px Arial`;for(let t=0;t<6;t++){m=t*i.height+y;for(let e=0;e<7;e++)v=w+e*i.width,0===t&&e<h||p>g||(u.strokeRect(v,m,i.width,i.height),u.fillText(p.toString(),v+i.width/2,m+S),p++)}}const ct=[];function at(e,n=t){let o;const i=new Set;function c(t){if(r(e,t)&&(e=t,o)){const t=!ct.length;for(const t of i)t[1](),ct.push(t,e);if(t){for(let t=0;t<ct.length;t+=2)ct[t][0](ct[t+1]);ct.length=0}}}function a(t){c(t(e))}return{set:c,update:a,subscribe:function(r,s=t){const l=[r,s];return i.add(l),1===i.size&&(o=n(c,a)||t),r(e),()=>{i.delete(l),0===i.size&&o&&(o(),o=null)}}}}const st=["January","February","March","April","May","June","July","August","September","October","November","December"],lt=Object.freeze({x:25,y:0,width:0,height:0,type:"calendar"});"function"==typeof SuppressedError&&SuppressedError;const ut=(t,e)=>e.some((e=>t instanceof e));let dt,ft;const ht=new WeakMap,gt=new WeakMap,pt=new WeakMap,vt=new WeakMap,mt=new WeakMap;let bt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return gt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||pt.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function wt(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ft||(ft=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply($t(this),e),xt(ht.get(this))}:function(...e){return xt(t.apply($t(this),e))}:function(e,...n){const o=t.call($t(this),e,...n);return pt.set(o,e.sort?e.sort():[e]),xt(o)}}function yt(t){return"function"==typeof t?wt(t):(t instanceof IDBTransaction&&function(t){if(gt.has(t))return;const e=new Promise(((e,n)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",r),t.removeEventListener("abort",r)},i=()=>{e(),o()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",r),t.addEventListener("abort",r)}));gt.set(t,e)}(t),ut(t,dt||(dt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,bt):t)}function xt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",r)},i=()=>{e(xt(t.result)),o()},r=()=>{n(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&ht.set(e,t)})).catch((()=>{})),mt.set(e,t),e}(t);if(vt.has(t))return vt.get(t);const e=yt(t);return e!==t&&(vt.set(t,e),mt.set(e,t)),e}const $t=t=>mt.get(t);const kt=["get","getKey","getAll","getAllKeys","count"],_t=["put","add","delete","clear"],St=new Map;function Ot(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(St.get(e))return St.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,i=_t.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!i&&!kt.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,i?"readwrite":"readonly");let c=r.store;return o&&(c=c.index(e.shift())),(await Promise.all([c[n](...e),i&&r.done]))[0]};return St.set(e,r),r}let Dt;async function It(){return Dt||(Dt=function(t,e,{blocked:n,upgrade:o,blocking:i,terminated:r}={}){const c=indexedDB.open(t,e),a=xt(c);return o&&c.addEventListener("upgradeneeded",(t=>{o(xt(c.result),t.oldVersion,t.newVersion,xt(c.transaction),t)})),n&&c.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{r&&t.addEventListener("close",(()=>r())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}("calendar-app-db",1,{upgrade(t){t.createObjectStore("images")}})),Dt}async function Et(t,e){const n=`${t}_${e}`;return(await It()).transaction("images","readonly").store.get(n)}function Rt(t,e){var n,o;if(!e)return;const i=null!==(o=null===(n=e.months)||void 0===n?void 0:n.map((t=>{const{backgroundImage:e}=t,n=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n}(t,["backgroundImage"]);return Object.assign(Object.assign({},n),{backgroundImage:Object.assign(Object.assign({},e),{value:null})})})))&&void 0!==o?o:[],r=Object.assign(Object.assign({},e),{months:i});localStorage.setItem(t,JSON.stringify(r)),jt.set(r)}bt=(t=>({...t,get:(e,n,o)=>Ot(e,n)||t.get(e,n,o),has:(e,n)=>!!Ot(e,n)||t.has(e,n)}))(bt);const jt=at(void 0),Ct=at(),Lt=at(void 0),Bt=at(0),Ft=at(0);const Wt=at(Array(12).fill(null).map((()=>({backgroundImage:{value:null,isDirty:!1},backgroundRect:{value:{x:0,y:0,width:0,height:0,type:"background"},isDirty:!1},calendarRect:{value:Object.assign({},lt),isDirty:!1},calendarColor:{value:"#ffffff",isDirty:!1},boxSize:{value:{width:100,height:100},isDirty:!1},imageFitOption:{value:tt.Fill,isDirty:!1}})))),At=at((new Date).getMonth()),Mt=at((new Date).getFullYear()),zt=function(e,n,r){const a=!Array.isArray(e),s=a?[e]:e;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=n.length<2;return u=(e,r)=>{let u=!1;const d=[];let f=0,h=t;const g=()=>{if(f)return;h();const o=n(a?d[0]:d,e,r);l?e(o):h=i(o)?o:t},p=s.map(((t,e)=>c(t,(t=>{d[e]=t,f&=~(1<<e),u&&g()}),(()=>{f|=1<<e}))));return u=!0,g(),function(){o(p),h(),u=!1}},{subscribe:at(r,u).subscribe};var u}([Wt,At],(([t,e])=>t[e]));function Nt(t,e){const n=a(At);Wt.update((o=>{const i=o[n],r=a(Mt);i[t].value=e,i[t].isDirty=!0,Pt(t,e,r,n);for(let n=0;n<o.length;n++){const i=o[n];i[t].isDirty||(i[t].value=e,Pt(t,e,r,n))}const c=a(jt);return c&&(c.months=o),Rt(r.toString(),c),o}))}function Pt(t,e,n,o){"backgroundImage"===t&&async function(t,e,n){const o=await It(),i=await fetch(n.src),r=await i.blob(),c=`${t}_${e}`;console.log("trying to save",c);const a=o.transaction("images","readwrite");a.store.put(r,c),await a.done}(n,o,e)}function Ht(t){let e,n,i,r,c,a,s,f,p,w,y,$,k,S;return{c(){e=h("div"),n=h("div"),n.innerHTML='<span class="reset-icon svelte-1kklcfk">×</span>',i=v(),r=g("svg"),c=g("rect"),f=g("rect"),b(n,"class","reset-button svelte-1kklcfk"),_(n,"left-aligned",t[1]),_(n,"right-aligned",!t[1]),b(c,"class","dashed-main svelte-1kklcfk"),b(c,"x","0"),b(c,"y","0"),b(c,"width",a=t[0].width),b(c,"height",s=t[0].height),b(c,"stroke","white"),b(c,"stroke-width","2"),b(c,"fill","none"),b(f,"class","dashed-alternate svelte-1kklcfk"),b(f,"x","0"),b(f,"y","0"),b(f,"width",p=t[0].width),b(f,"height",w=t[0].height),b(f,"stroke","black"),b(f,"stroke-width","2"),b(f,"fill","none"),b(r,"xmlns","http://www.w3.org/2000/svg"),b(r,"width",y=t[0].width),b(r,"height",$=t[0].height),b(e,"class","bounding-box svelte-1kklcfk"),x(e,"left",t[0].x+"px"),x(e,"top",t[0].y+"px")},m(o,a){u(o,e,a),l(e,n),t[7](n),l(e,i),l(e,r),l(r,c),l(r,f),k||(S=[m(n,"pointerup",t[6]),m(e,"pointerdown",t[3]),m(e,"pointerup",t[5]),m(e,"pointermove",t[4])],k=!0)},p(t,o){2&o&&_(n,"left-aligned",t[1]),2&o&&_(n,"right-aligned",!t[1]),1&o&&a!==(a=t[0].width)&&b(c,"width",a),1&o&&s!==(s=t[0].height)&&b(c,"height",s),1&o&&p!==(p=t[0].width)&&b(f,"width",p),1&o&&w!==(w=t[0].height)&&b(f,"height",w),1&o&&y!==(y=t[0].width)&&b(r,"width",y),1&o&&$!==($=t[0].height)&&b(r,"height",$),1&o&&x(e,"left",t[0].x+"px"),1&o&&x(e,"top",t[0].y+"px")},d(n){n&&d(e),t[7](null),k=!1,o(S)}}}function Tt(e){let n,o=e[0]&&Ht(e);return{c(){o&&o.c(),n=p("")},m(t,e){o&&o.m(t,e),u(t,n,e)},p(t,[e]){t[0]?o?o.p(t,e):(o=Ht(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){t&&d(n),o&&o.d(t)}}}function Yt(t,e,n){const o=E();let{currentSelectedImage:i}=e;const r=Lt.subscribe((t=>{n(0,i=t)}));let c,a=0,s=0,l=!1,u=!1,d=!1;var f;return f=()=>{r()},D().$$.on_destroy.push(f),t.$$set=t=>{"currentSelectedImage"in t&&n(0,i=t.currentSelectedImage)},t.$$.update=()=>{1&t.$$.dirty&&n(1,d=i&&i.x+i.width>window.innerWidth)},[i,d,c,function(t){i&&(a=t.clientX,s=t.clientY,l=!0,u=!1)},function(t){if(!l)return;const e=t.clientX-a,o=t.clientY-s,r=Object.assign(Object.assign({},i),{x:i.x+e,y:i.y+o});n(0,i.x+=e,i),n(0,i.y+=o,i),a=t.clientX,s=t.clientY,0===e&&0===o||(u=!0),Nt("calendar"===r.type?"calendarRect":"backgroundRect",r)},function(t){l=!1,(u||c.contains(t.target))&&t.stopPropagation(),u=!1},function(){n(0,i.x=0,i),n(0,i.y=0,i),o("imageMoved",i)},function(t){j[t?"unshift":"push"]((()=>{c=t,n(2,c)}))}]}class Jt extends Z{constructor(t){super(),Q(this,t,Yt,Tt,r,{currentSelectedImage:0})}}function Xt(t,e,n=1){const o=new Date(t,e+1,0).getDate(),i=new Date(t,e,1).getDay()-n;return Math.ceil((o+i)/7)}function Kt(t,e,n,o=1){return t*(Xt(e,n,1)+1)}function Vt(e){let n,o,i;return{c(){n=h("div"),b(n,"class","resizer svelte-1kukuk1"),x(n,"left",e[0].x+e[0].width+"px"),x(n,"top",e[0].y+e[0].height+"px")},m(t,r){var c;u(t,n,r),o||(i=m(n,"pointerdown",(c=e[1],function(t){return t.stopPropagation(),c.call(this,t)})),o=!0)},p(t,[e]){1&e&&x(n,"left",t[0].x+t[0].width+"px"),1&e&&x(n,"top",t[0].y+t[0].height+"px")},i:t,o:t,d(t){t&&d(n),o=!1,i()}}}function Ut(t,e,n){let o,i,r;s(t,At,(t=>n(6,o=t))),s(t,Mt,(t=>n(7,i=t))),s(t,zt,(t=>n(8,r=t)));let c,a,l,{imageRect:u}=e,d=!1;function f(t){if(!d)return;const e=t.clientX-c,n=t.clientY-a;Nt("boxSize",{width:(7*l.width+e)/7,height:(Kt(l.height,i,o,1)+n)/(Xt(i,o,1)+1)})}function h(t){d=!1,window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",h)}return t.$$set=t=>{"imageRect"in t&&n(0,u=t.imageRect)},[u,function(t){d=!0,c=t.clientX,a=t.clientY,l={width:r.boxSize.value.width,height:r.boxSize.value.height},window.addEventListener("pointermove",f),window.addEventListener("pointerup",h),window.addEventListener("pointercancel",h)}]}class qt extends Z{constructor(t){super(),Q(this,t,Ut,Vt,r,{imageRect:0})}}function Gt(t,e,n){const o=t.slice();return o[22]=e[n],o}function Qt(t,e,n){const o=t.slice();return o[25]=e[n],o[27]=n,o}function Zt(e){let n;return{c(){n=h("option"),n.textContent=`${e[25]}`,n.__value=e[27],y(n,n.__value)},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function te(e){let n,o,i=et[e[22]]+"";return{c(){n=h("option"),o=p(i),n.__value=e[22],y(n,n.__value)},m(t,e){u(t,n,e),l(n,o)},p:t,d(t){t&&d(n)}}}function ee(e){let n,i,r,c,a,s,g,k,_,S,O,D,I,E,R,j,C,L,B,F,A,M=X(st),z=[];for(let t=0;t<M.length;t+=1)z[t]=Zt(Qt(e,M,t));let N=X(Object.values(tt)),P=[];for(let t=0;t<N.length;t+=1)P[t]=te(Gt(e,N,t));return{c(){n=h("input"),i=v(),r=h("select");for(let t=0;t<z.length;t+=1)z[t].c();c=v(),a=h("label"),a.textContent="Calendar Width:",s=v(),g=h("input"),k=v(),_=h("label"),_.textContent="Calendar Height:",S=v(),O=h("input"),D=v(),I=h("label"),E=p("Color:\r\n  "),R=h("input"),j=v(),C=h("div"),L=v(),B=h("select");for(let t=0;t<P.length;t+=1)P[t].c();b(n,"type","file"),b(n,"accept","image/*"),void 0===e[4]&&W((()=>e[8].call(r))),b(a,"for","boxSizeWidth"),b(g,"id","boxSizeWidth"),b(g,"type","number"),b(g,"min","50"),b(_,"for","boxSizeHeight"),b(O,"id","boxSizeHeight"),b(O,"type","number"),b(O,"min","50"),b(R,"type","color"),b(R,"class","calendar-color-picker"),b(R,"id","calendar-color-picker"),b(C,"class","color-display"),x(C,"background-color",e[0]),x(C,"border-color",e[2]),b(I,"for","calendar-color-picker"),b(I,"class","color-picker-container"),void 0===e[3]&&W((()=>e[13].call(B)))},m(t,o){u(t,n,o),u(t,i,o),u(t,r,o);for(let t=0;t<z.length;t+=1)z[t]&&z[t].m(r,null);$(r,e[4],!0),u(t,c,o),u(t,a,o),u(t,s,o),u(t,g,o),y(g,e[1].width),u(t,k,o),u(t,_,o),u(t,S,o),u(t,O,o),y(O,e[1].height),u(t,D,o),u(t,I,o),l(I,E),l(I,R),y(R,e[0]),l(I,j),l(I,C),u(t,L,o),u(t,B,o);for(let t=0;t<P.length;t+=1)P[t]&&P[t].m(B,null);$(B,e[3],!0),F||(A=[m(n,"input",e[5]),m(r,"change",e[8]),m(g,"input",e[9]),m(g,"input",e[6]),m(O,"input",e[10]),m(O,"input",e[6]),m(R,"input",e[11]),m(R,"input",e[12]),m(B,"change",e[13]),m(B,"change",e[7])],F=!0)},p(t,[e]){if(16&e&&$(r,t[4]),2&e&&w(g.value)!==t[1].width&&y(g,t[1].width),2&e&&w(O.value)!==t[1].height&&y(O,t[1].height),1&e&&y(R,t[0]),1&e&&x(C,"background-color",t[0]),4&e&&x(C,"border-color",t[2]),0&e){let n;for(N=X(Object.values(tt)),n=0;n<N.length;n+=1){const o=Gt(t,N,n);P[n]?P[n].p(o,e):(P[n]=te(o),P[n].c(),P[n].m(B,null))}for(;n<P.length;n+=1)P[n].d(1);P.length=N.length}8&e&&$(B,t[3])},i:t,o:t,d(t){t&&(d(n),d(i),d(r),d(c),d(a),d(s),d(g),d(k),d(_),d(S),d(O),d(D),d(I),d(L),d(B)),f(z,t),f(P,t),F=!1,o(A)}}}function ne(t,e,n){let o,i,r,c,a;s(t,At,(t=>n(4,o=t))),s(t,Mt,(t=>n(15,i=t))),s(t,zt,(t=>n(16,r=t))),s(t,Ft,(t=>n(17,c=t))),s(t,Bt,(t=>n(18,a=t)));let l,u={width:100,height:100},d="#FFFFFF",f="",h=tt.Fill;function g(t){n(0,d=t.calendarColor.value),n(1,u=Object.assign({},t.boxSize.value)),l=t.backgroundImage.value,n(3,h=t.imageFitOption.value)}function p(){const t=r.calendarRect.value;t.width=7*u.width,t.height=Kt(u.height,i,o,1),Nt("calendarRect",Object.assign({},t))}I((()=>{g(r);let t=r;const e=[zt.subscribe((()=>{t!==r&&g(r),t=r}))];return p(),()=>{e.forEach((t=>t()))}}));return t.$$.update=()=>{1&t.$$.dirty&&n(2,f=function(t){const e=parseInt(t.replace("#",""),16);return.2126*(e>>16&255)+.7152*(e>>8&255)+.0722*(e>>0&255)<32}(d)?"transparent":"black")},[d,u,f,h,o,function(t){const e=t.target.files[0],n=new FileReader;n.onload=t=>{l=new Image,l.src=t.target.result,l.onload=()=>(Nt("backgroundImage",l),Ct.set(l),void Nt("backgroundRect",Object.assign(Object.assign({},r.backgroundRect.value),{width:a,height:c})))},n.readAsDataURL(e)},function(){Nt("boxSize",Object.assign({},u)),p()},function(){Nt("imageFitOption",h)},function(){o=k(this),At.set(o)},function(){u.width=w(this.value),n(1,u)},function(){u.height=w(this.value),n(1,u)},function(){d=this.value,n(0,d)},()=>Nt("calendarColor",d),function(){h=k(this),n(3,h)}]}class oe extends Z{constructor(t){super(),Q(this,t,ne,ee,r,{})}}function ie(t){let e,n,o;function i(e){t[21](e)}let r={};return void 0!==t[1]&&(r.imageRect=t[1]),e=new qt({props:r}),j.push((()=>K(e,"imageRect",i))),{c(){V(e.$$.fragment)},m(t,n){U(e,t,n),o=!0},p(t,o){const i={};!n&&2&o&&(n=!0,i.imageRect=t[1],A((()=>n=!1))),e.$set(i)},i(t){o||(Y(e.$$.fragment,t),o=!0)},o(t){J(e.$$.fragment,t),o=!1},d(t){q(e,t)}}}function re(t){let e,n,i,r,c,a,s,f,g,p,x,k,_,S,O,D,I,E,R,C,L,B,F,M,z,N,P,H,X,G,Q,Z,tt,et,nt,ot,it,rt,ct,at,st;function lt(e){t[19](e)}Q=new oe({});let ut={};void 0!==t[1]&&(ut.currentSelectedImage=t[1]),et=new Jt({props:ut}),j.push((()=>K(et,"currentSelectedImage",lt))),et.$on("imageMoved",t[20]);let dt="calendar"===t[1]?.type&&ie(t);return{c(){e=h("div"),n=h("input"),i=v(),r=h("button"),r.textContent="Export Calendar",c=v(),a=h("button"),a.textContent="Export Year",s=v(),f=h("div"),g=h("label"),g.textContent="Canvas Width:",p=v(),x=h("input"),k=v(),_=h("label"),_.textContent="Canvas Height:",S=v(),O=h("input"),D=v(),I=h("select"),E=h("option"),E.textContent="Fit to background image",R=h("option"),R.textContent="800x600",C=h("option"),C.textContent="1024x768",L=h("option"),L.textContent="1280x720 (720p)",B=h("option"),B.textContent="1920x1080 (1080p)",F=h("option"),F.textContent="2560x1440 (1440p)",M=h("option"),M.textContent="3840x2160 (4K)",z=h("option"),z.textContent="5120x2880 (5K)",N=h("option"),N.textContent="7680x4320 (8K)",P=v(),H=h("button"),H.textContent="Reset Rects",X=v(),G=h("div"),V(Q.$$.fragment),Z=v(),tt=h("div"),V(et.$$.fragment),ot=v(),dt&&dt.c(),it=v(),rt=h("canvas"),b(n,"type","number"),b(n,"min","1"),b(e,"class","settings svelte-1liei12"),b(g,"for","canvasWidth"),b(x,"id","canvasWidth"),b(x,"type","number"),b(x,"min","300"),b(_,"for","canvasHeight"),b(O,"id","canvasHeight"),b(O,"type","number"),b(O,"min","300"),E.__value="auto",y(E,E.__value),R.__value="800x600",y(R,R.__value),C.__value="1024x768",y(C,C.__value),L.__value="1280x720",y(L,L.__value),B.__value="1920x1080",y(B,B.__value),F.__value="2560x1440",y(F,F.__value),M.__value="3840x2160",y(M,M.__value),z.__value="5120x2880",y(z,z.__value),N.__value="7680x4320",y(N,N.__value),void 0===t[0]&&W((()=>t[17].call(I))),b(f,"class","settings svelte-1liei12"),b(G,"class","settings svelte-1liei12"),b(rt,"width",t[4]),b(rt,"height",t[5]),b(rt,"class","svelte-1liei12"),b(tt,"class","canvas-container svelte-1liei12")},m(o,d){u(o,e,d),l(e,n),y(n,t[2]),l(e,i),l(e,r),l(e,c),l(e,a),u(o,s,d),u(o,f,d),l(f,g),l(f,p),l(f,x),y(x,t[4]),l(f,k),l(f,_),l(f,S),l(f,O),y(O,t[5]),l(f,D),l(f,I),l(I,E),l(I,R),l(I,C),l(I,L),l(I,B),l(I,F),l(I,M),l(I,z),l(I,N),$(I,t[0],!0),l(f,P),l(f,H),u(o,X,d),u(o,G,d),U(Q,G,null),u(o,Z,d),u(o,tt,d),U(et,tt,null),l(tt,ot),dt&&dt.m(tt,null),l(tt,it),l(tt,rt),t[22](rt),ct=!0,at||(st=[m(n,"input",t[12]),m(r,"click",t[7]),m(a,"click",t[8]),m(x,"input",t[13]),m(x,"input",t[14]),m(O,"input",t[15]),m(O,"input",t[16]),m(I,"change",t[17]),m(I,"change",t[18]),m(H,"click",t[10])],at=!0)},p(t,[e]){4&e&&w(n.value)!==t[2]&&y(n,t[2]),16&e&&w(x.value)!==t[4]&&y(x,t[4]),32&e&&w(O.value)!==t[5]&&y(O,t[5]),1&e&&$(I,t[0]);const i={};!nt&&2&e&&(nt=!0,i.currentSelectedImage=t[1],A((()=>nt=!1))),et.$set(i),"calendar"===t[1]?.type?dt?(dt.p(t,e),2&e&&Y(dt,1)):(dt=ie(t),dt.c(),Y(dt,1),dt.m(tt,it)):dt&&(T={r:0,c:[],p:T},J(dt,1,1,(()=>{dt=null})),T.r||o(T.c),T=T.p),(!ct||16&e)&&b(rt,"width",t[4]),(!ct||32&e)&&b(rt,"height",t[5])},i(t){ct||(Y(Q.$$.fragment,t),Y(et.$$.fragment,t),Y(dt),ct=!0)},o(t){J(Q.$$.fragment,t),J(et.$$.fragment,t),J(dt),ct=!1},d(n){n&&(d(e),d(s),d(f),d(X),d(G),d(Z),d(tt)),q(Q),q(et),dt&&dt.d(),t[22](null),at=!1,o(st)}}}function ce(t,e,n){let o,i,r,c,a,l,u,d;s(t,zt,(t=>n(24,o=t))),s(t,Bt,(t=>n(4,i=t))),s(t,Ft,(t=>n(5,r=t))),s(t,Wt,(t=>n(25,c=t))),s(t,Mt,(t=>n(2,a=t))),s(t,At,(t=>n(26,l=t))),s(t,jt,(t=>n(11,u=t)));let f,h="auto",g=!1;function p(){g||(g=!0,requestAnimationFrame((()=>{0!==i&&0!==r&&rt({monthIndex:l,year:a,month:o,canvas:d,firstDayOfWeek:1,locale:"en-GB"}),g=!1})))}function v(){p()}function m(){if("auto"===h){const t=o.backgroundImage.value;t&&(Bt.set(t.naturalWidth),Ft.set(t.naturalHeight))}else{const[t,e]=h.split("x").map(Number);Bt.set(t),Ft.set(e)}}function b(t){const e=d.getBoundingClientRect(),i=o.calendarRect.value,r=o.backgroundRect.value,c=t.pageX-e.left-window.scrollX,a=t.pageY-e.top-window.scrollY;c<0||c>e.width||a<0||a>e.height?n(1,f=void 0):c>=i.x&&c<=i.x+i.width&&a>=i.y&&a<=i.y+i.height?n(1,f=i):c>=r.x&&c<=r.x+r.width&&a>=r.y&&a<=r.y+r.height?n(1,f=r):n(1,f=void 0)}I((()=>{let t=function(t){const e=localStorage.getItem(t);return e?JSON.parse(e):null}(a.toString());t?Wt.set(t.months):(t={canvasHeight:r,canvasWidth:i,selectedResolution:h,months:c},Rt(a.toString(),t)),jt.set(t),Bt.set(u.canvasWidth),Ft.set(u.canvasHeight),n(0,h=u.selectedResolution);const e=[Mt.subscribe((()=>v())),zt.subscribe((()=>{v(),function(){if(!f)return void Lt.set(f);let t="background"===f.type?o.backgroundRect.value:o.calendarRect.value;n(1,f=t),Lt.set(f)}()})),Ct.subscribe((()=>m())),Bt.subscribe((()=>{const t=o.backgroundRect.value;t.width=i;const e=u,n=Object.assign(Object.assign({},e),{canvasWidth:i});Rt(a.toString(),n),Nt("backgroundRect",t),p()})),Ft.subscribe((()=>{const t=o.backgroundRect.value;t.height=r;const e=u,n=Object.assign(Object.assign({},e),{canvasHeight:r});Rt(a.toString(),n),Nt("backgroundRect",t),p()}))];return At.set((new Date).getMonth()),async function(t,e,n){if(e)for(let o=0;o<e.months.length;o++){const e=await Et(t.toString(),o.toString());if(!e)continue;const i=new Image;i.onload=()=>{n.update((t=>(t[o].backgroundImage.value=i,t)))},i.src=URL.createObjectURL(e)}}(a,t,Wt).then((()=>p())),p(),window.addEventListener("pointerup",b),()=>{e.forEach((t=>t())),window.removeEventListener("pointerup",b)}}));return t.$$.update=()=>{if(2&t.$$.dirty&&f&&Lt.set(f),2053&t.$$.dirty&&u){const t=u,e=Object.assign(Object.assign({},t),{selectedResolution:h});Rt(a.toString(),e)}},[h,f,a,d,i,r,p,function(){const t=d.toDataURL("image/png"),e=document.createElement("a");e.href=t;const n=`${Mt}_${st[At]}.png`;e.download=n,e.click()},function(){const t=function(t){const{year:e,months:n,firstDayOfWeek:o,cellWidth:i,cellHeight:r,cellSpacing:c}=t,a=document.createElement("canvas");a.width=i,a.height=12*(r+c);const s=a.getContext("2d"),l=document.createElement("canvas");l.width=i,l.height=r;for(let t=0;t<12;t++){rt({monthIndex:t,month:n[t],year:e,canvas:l,firstDayOfWeek:o});const a=0,u=t*(r+c);s.drawImage(l,a,u,i,r)}return a}({year:a,months:c,firstDayOfWeek:1,cellHeight:r,cellWidth:i,cellSpacing:5}),e=t.toDataURL("image/png"),n=document.createElement("a");n.href=e,n.download=`calendar-${Mt}.png`,n.click()},m,function(){const t=o.calendarRect.value,e=o.backgroundRect.value;t.x=lt.x,t.y=lt.y,e.x=0,e.y=0,Nt("calendarRect",t),Nt("backgroundRect",e),p()},u,function(){a=w(this.value),Mt.set(a)},function(){i=w(this.value),Bt.set(i)},()=>p(),function(){r=w(this.value),Ft.set(r)},()=>p(),function(){h=k(this),n(0,h)},()=>m(),function(t){f=t,n(1,f)},()=>{p()},function(t){f=t,n(1,f)},function(t){j[t?"unshift":"push"]((()=>{d=t,n(3,d)}))}]}class ae extends Z{constructor(t){super(),Q(this,t,ce,re,r,{})}}function se(e){let n,o,i;return o=new ae({}),{c(){n=h("main"),V(o.$$.fragment)},m(t,e){u(t,n,e),U(o,n,null),i=!0},p:t,i(t){i||(Y(o.$$.fragment,t),i=!0)},o(t){J(o.$$.fragment,t),i=!1},d(t){t&&d(n),q(o)}}}return new class extends Z{constructor(t){super(),Q(this,t,null,se,r,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
